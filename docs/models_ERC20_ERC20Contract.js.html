<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/ERC20/ERC20Contract.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/ERC20/ERC20Contract.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { ierc20 } from "../../interfaces";
import Numbers from "../../utils/Numbers";
import IContract from "../IContract";

/**
 * @class ERC20Contract
 * @param params.web3 {Web3}
 * @param params.contractAddress {Address}
 * @param params.acc {*}
 */
class ERC20Contract extends IContract {
  constructor(params) {
    super({ abi: ierc20, ...params });
  }

  __assert = async () => {
    this.params.contract.use(ierc20, this.getAddress());
    this.params.decimals = await this.getDecimalsAsync();
  };

  getContract() {
    return this.params.contract.getContract();
  }

  getAddress() {
    return this.params.contractAddress;
  }

  async transferTokenAmount({ toAddress, tokenAmount }) {
    let amountWithDecimals = Numbers.toSmartContractDecimals(
      tokenAmount,
      this.getDecimals()
    );
    return await this.__sendTx(
      this.params.contract
        .getContract()
        .methods.transfer(toAddress, amountWithDecimals)
    );
  }

  async getTokenAmount(address) {
    return Numbers.fromDecimals(
      await this.getContract().methods.balanceOf(address).call(),
      this.getDecimals()
    );
  }

  async totalSupply() {
    return Numbers.fromDecimals(
      await this.getContract().methods.totalSupply().call(),
      this.getDecimals()
    );
  }

  getABI() {
    return this.params.contract;
  }

  getDecimals() {
    return this.params.decimals;
  }

  async getDecimalsAsync() {
    return await this.getContract().methods.decimals().call();
  }

  async isApproved({ address, amount, spenderAddress }) {
    try {
      let approvedAmount = Numbers.fromDecimals(
        await this.getContract()
          .methods.allowance(address, spenderAddress)
          .call(),
        this.getDecimals()
      );
      return approvedAmount >= amount;
    } catch (err) {
      throw err;
    }
  }

  async approve({ address, amount, callback }) {
    try {
      let amountWithDecimals = Numbers.toSmartContractDecimals(
        amount,
        this.getDecimals()
      );
      let res = await this.__sendTx(
        this.params.contract
          .getContract()
          .methods.approve(address, amountWithDecimals),
        null,
        null,
        callback
      );
      return res;
    } catch (err) {
      throw err;
    }
  }

  deploy = async ({ name, symbol, cap, distributionAddress, callback }) => {
    if (!distributionAddress) {
      throw new Error("Please provide an Distribution address for distro");
    }

    if (!name) {
      throw new Error("Please provide a name");
    }

    if (!symbol) {
      throw new Error("Please provide a symbol");
    }

    if (!cap) {
      throw new Error("Please provide a cap");
    }
    let params = [name, symbol, cap, distributionAddress];
    let res = await this.__deploy(params, callback);
    this.params.contractAddress = res.contractAddress;
    /* Call to Backend API */
    await this.__assert();
    return res;
  };
}

export default ERC20Contract;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Documentation</a></h2><div class="category"><h2>Main</h2><h3>Classes </h3><ul><li><a href="BEPRONetwork.html">BEPRONetwork</a></li><li><a href="ERC20Contract.html">ERC20Contract</a></li><li><a href="ERC20TokenLock.html">ERC20TokenLock</a></li><li><a href="ERC721Collectibles.html">ERC721Collectibles</a></li><li><a href="ERC721Contract.html">ERC721Contract</a></li><li><a href="ExchangeContract.html">ExchangeContract</a></li><li><a href="IContract.html">IContract</a></li><li><a href="OpenerRealFvr.html">OpenerRealFvr</a></li><li><a href="StakingContract.html">StakingContract</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getAddress">getAddress</a></li><li><a href="global.html#getERC20Contract">getERC20Contract</a></li><li><a href="global.html#getERC20TokenLock">getERC20TokenLock</a></li><li><a href="global.html#getERC721Collectibles">getERC721Collectibles</a></li><li><a href="global.html#getETHBalance">getETHBalance</a></li><li><a href="global.html#getETHNetwork">getETHNetwork</a></li><li><a href="global.html#getExchangeContract">getExchangeContract</a></li><li><a href="global.html#getOpenRealFvrContract">getOpenRealFvrContract</a></li><li><a href="global.html#getStakingContract">getStakingContract</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#start">start</a></li></ul></div>
    
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Fri May 07 2021 11:31:42 GMT+0100 (WEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
